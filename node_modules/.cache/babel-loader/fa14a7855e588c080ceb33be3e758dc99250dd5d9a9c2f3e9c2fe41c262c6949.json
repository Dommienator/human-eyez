{"ast":null,"code":"var _jsxFileName = \"D:\\\\Kazi Strong\\\\HumanEyez\\\\src\\\\pages\\\\PaymentPage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useSearchParams, useNavigate } from \"react-router-dom\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport Header from \"../components/Header\";\nimport Footer from \"../components/Footer\";\nimport { supabase, createNotification } from \"../services/supabase\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(process.env.REACT_APP_STRIPE_PUBLIC_KEY || \"\");\nconst PaymentPage = () => {\n  _s();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const amount = searchParams.get(\"amount\");\n  const [isLocal] = useState(window.location.hostname === \"localhost\");\n  const [selectedMethod, setSelectedMethod] = useState(null);\n  const [processing, setProcessing] = useState(false);\n  const [mpesaPhone, setMpesaPhone] = useState(\"\");\n  const handleStripePayment = async () => {\n    setProcessing(true);\n    setSelectedMethod(\"stripe\");\n    try {\n      const orderDataString = sessionStorage.getItem(\"orderToCreate\");\n      if (!orderDataString) {\n        alert(\"Order data not found\");\n        navigate(\"/order\");\n        return;\n      }\n      const orderData = JSON.parse(orderDataString);\n\n      // Create Stripe checkout session\n      const response = await fetch(\"/api/create-stripe-checkout\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          amount: parseFloat(amount),\n          orderData: orderData\n        })\n      });\n      const {\n        sessionId\n      } = await response.json();\n\n      // Redirect to Stripe checkout\n      const stripe = await stripePromise;\n      const {\n        error\n      } = await stripe.redirectToCheckout({\n        sessionId\n      });\n      if (error) {\n        console.error(\"Stripe error:\", error);\n        alert(\"Payment failed. Please try again.\");\n        setProcessing(false);\n      }\n    } catch (error) {\n      console.error(\"Error:\", error);\n      alert(\"Payment failed. Please try again.\");\n      setProcessing(false);\n    }\n  };\n  const handleMpesaPayment = async () => {\n    if (!mpesaPhone || mpesaPhone.length < 10) {\n      alert(\"Please enter a valid phone number\");\n      return;\n    }\n    setProcessing(true);\n    setSelectedMethod(\"mpesa\");\n    try {\n      const orderDataString = sessionStorage.getItem(\"orderToCreate\");\n      if (!orderDataString) {\n        alert(\"Order data not found\");\n        navigate(\"/order\");\n        return;\n      }\n      const orderData = JSON.parse(orderDataString);\n\n      // Initiate M-Pesa STK Push\n      const response = await fetch(\"/api/mpesa-stk-push\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          phone: mpesaPhone,\n          amount: parseFloat(amount),\n          orderNumber: \"PENDING\",\n          // Will be created after payment\n          orderData: orderData\n        })\n      });\n      const result = await response.json();\n      if (result.success) {\n        alert(\"‚úÖ M-Pesa prompt sent to your phone! Enter your PIN to complete payment.\");\n        // Poll for payment confirmation\n        startMpesaPolling(result.checkoutRequestID, orderData);\n      } else {\n        alert(\"M-Pesa payment failed: \" + result.message);\n        setProcessing(false);\n      }\n    } catch (error) {\n      console.error(\"Error:\", error);\n      alert(\"Payment failed. Please try again.\");\n      setProcessing(false);\n    }\n  };\n  const startMpesaPolling = (checkoutRequestID, orderData) => {\n    let attempts = 0;\n    const maxAttempts = 30; // 30 seconds\n\n    const pollInterval = setInterval(async () => {\n      attempts++;\n      try {\n        // Check payment status (you'd need to create this endpoint)\n        const response = await fetch(`/api/mpesa-check-status?id=${checkoutRequestID}`);\n        const result = await response.json();\n        if (result.status === \"completed\") {\n          clearInterval(pollInterval);\n          await createOrderAfterPayment(orderData);\n        } else if (result.status === \"failed\" || attempts >= maxAttempts) {\n          clearInterval(pollInterval);\n          alert(\"Payment failed or timed out\");\n          setProcessing(false);\n        }\n      } catch (error) {\n        console.error(\"Polling error:\", error);\n      }\n    }, 1000);\n  };\n  const simulatePayment = async () => {\n    setProcessing(true);\n    setSelectedMethod(\"simulate\");\n    const orderDataString = sessionStorage.getItem(\"orderToCreate\");\n    if (!orderDataString) {\n      alert(\"Order data not found. Please start over.\");\n      navigate(\"/order\");\n      return;\n    }\n    const orderData = JSON.parse(orderDataString);\n    await createOrderAfterPayment(orderData);\n  };\n  const createOrderAfterPayment = async orderData => {\n    console.log(\"üí≥ Payment successful, creating order...\");\n    console.log(\"üì¶ Order data:\", JSON.stringify(orderData, null, 2));\n    const {\n      data,\n      error\n    } = await supabase.from(\"orders\").insert([{\n      ...orderData,\n      payment_status: \"paid\",\n      status: \"in-progress\"\n    }]).select().single();\n    if (error) {\n      console.error(\"‚ùå FULL ERROR OBJECT:\", error);\n      console.error(\"‚ùå Error message:\", error.message);\n      console.error(\"‚ùå Error details:\", error.details);\n      console.error(\"‚ùå Error hint:\", error.hint);\n      console.error(\"‚ùå Error code:\", error.code);\n      alert(`Failed to create order. Error: ${error.message}`);\n      setProcessing(false);\n      return;\n    }\n    console.log(\"‚úÖ Order created:\", data);\n\n    // Clear session\n    sessionStorage.removeItem(\"orderToCreate\");\n\n    // Notify customer\n    await createNotification(orderData.customer_email, \"new_order\", \"Order Placed Successfully! üéâ\", `Your order #${data.order_number} has been received and is being processed.`, \"/my-orders\");\n\n    // Notify admin\n    await createNotification(\"dommienik@yahoo.com\", \"new_order\", `New Order: #${data.order_number}`, `${orderData.customer_email} placed a new order. ${orderData.word_count} words, $${orderData.total_price}`, \"/admin\");\n    setTimeout(() => {\n      alert(\"‚úÖ Payment Successful! Your order is being processed.\");\n      navigate(\"/my-orders\");\n    }, 2000);\n  };\n  const styles = {\n    page: {\n      minHeight: \"100vh\",\n      display: \"flex\",\n      flexDirection: \"column\"\n    },\n    container: {\n      maxWidth: \"600px\",\n      margin: \"8rem auto\",\n      padding: \"0 2rem\",\n      textAlign: \"center\"\n    },\n    card: {\n      background: \"white\",\n      borderRadius: \"16px\",\n      padding: \"3rem\",\n      boxShadow: \"0 8px 24px rgba(0,0,0,0.1)\"\n    },\n    title: {\n      fontSize: \"2rem\",\n      color: \"#5A3A79\",\n      marginBottom: \"1rem\"\n    },\n    amount: {\n      fontSize: \"3rem\",\n      fontWeight: \"700\",\n      color: \"#6B4A8A\",\n      marginBottom: \"2rem\"\n    },\n    methodsGrid: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      gap: \"1.5rem\",\n      marginTop: \"2rem\"\n    },\n    methodCard: {\n      padding: \"1.5rem\",\n      borderRadius: \"12px\",\n      border: \"2px solid #e0e0e0\",\n      background: \"white\",\n      textAlign: \"left\",\n      transition: \"all 0.3s\"\n    },\n    methodHeader: {\n      display: \"flex\",\n      alignItems: \"center\",\n      gap: \"1rem\",\n      marginBottom: \"1rem\"\n    },\n    methodTitle: {\n      fontSize: \"1.2rem\",\n      fontWeight: \"700\",\n      color: \"#5A3A79\"\n    },\n    methodButton: {\n      padding: \"1rem\",\n      borderRadius: \"8px\",\n      border: \"none\",\n      background: \"#6B4A8A\",\n      color: \"white\",\n      cursor: \"pointer\",\n      fontSize: \"1rem\",\n      fontWeight: \"600\",\n      width: \"100%\",\n      transition: \"all 0.3s\"\n    },\n    disabledCard: {\n      opacity: 0.5,\n      background: \"#f5f5f5\"\n    },\n    disabledButton: {\n      background: \"#ccc\",\n      cursor: \"not-allowed\"\n    },\n    note: {\n      fontSize: \"0.9rem\",\n      color: \"#6b7e85\",\n      marginTop: \"0.5rem\",\n      fontStyle: \"italic\"\n    },\n    input: {\n      padding: \"0.8rem\",\n      borderRadius: \"8px\",\n      border: \"2px solid #e0e0e0\",\n      fontSize: \"1rem\",\n      width: \"100%\",\n      marginBottom: \"1rem\"\n    },\n    simulateCard: {\n      border: \"2px solid #f39c12\",\n      background: \"#fff9e6\"\n    },\n    simulateButton: {\n      background: \"#f39c12\"\n    },\n    spinner: {\n      display: \"inline-block\",\n      marginLeft: \"0.5rem\",\n      fontSize: \"1rem\"\n    }\n  };\n  if (processing) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.page,\n      children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.container,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.card,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            style: styles.title,\n            children: \"Processing Payment...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Please wait while we process your \", selectedMethod, \" payment.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: \"3rem\",\n              margin: \"2rem 0\"\n            },\n            children: \"\\u23F3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: styles.page,\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.container,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.card,\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          style: styles.title,\n          children: \"Complete Payment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.amount,\n          children: [\"$\", amount]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.methodsGrid,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              ...styles.methodCard,\n              ...(isLocal ? styles.disabledCard : {})\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.methodHeader,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontSize: \"2rem\"\n                },\n                children: \"\\uD83D\\uDCB3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 323,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                style: styles.methodTitle,\n                children: \"Credit/Debit Card\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              style: {\n                ...styles.methodButton,\n                ...(isLocal ? styles.disabledButton : {})\n              },\n              onClick: handleStripePayment,\n              disabled: isLocal || processing,\n              children: \"Pay with Stripe\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 15\n            }, this), isLocal && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.note,\n              children: \"Available on live site only\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              ...styles.methodCard,\n              ...(isLocal ? styles.disabledCard : {})\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.methodHeader,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontSize: \"2rem\"\n                },\n                children: \"\\uD83D\\uDCF1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 349,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                style: styles.methodTitle,\n                children: \"M-Pesa\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 15\n            }, this), !isLocal && /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"tel\",\n              style: styles.input,\n              placeholder: \"Phone: 0712345678\",\n              value: mpesaPhone,\n              onChange: e => setMpesaPhone(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              style: {\n                ...styles.methodButton,\n                ...(isLocal ? styles.disabledButton : {})\n              },\n              onClick: handleMpesaPayment,\n              disabled: isLocal || processing,\n              children: \"Pay with M-Pesa\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 15\n            }, this), isLocal && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.note,\n              children: \"Available on live site only\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              ...styles.methodCard,\n              ...(isLocal ? styles.disabledCard : {})\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.methodHeader,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontSize: \"2rem\"\n                },\n                children: \"\\uD83D\\uDCB0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 384,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                style: styles.methodTitle,\n                children: \"PayPal\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 385,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 383,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              style: {\n                ...styles.methodButton,\n                ...(isLocal ? styles.disabledButton : {})\n              },\n              disabled: isLocal || processing,\n              children: \"Pay with PayPal\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 387,\n              columnNumber: 15\n            }, this), isLocal && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.note,\n              children: \"Available on live site only\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 377,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              ...styles.methodCard,\n              ...styles.simulateCard\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.methodHeader,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontSize: \"2rem\"\n                },\n                children: \"\\uD83E\\uDDEA\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 404,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                style: styles.methodTitle,\n                children: \"Test Payment\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 405,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 403,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              style: {\n                ...styles.methodButton,\n                ...styles.simulateButton\n              },\n              onClick: simulatePayment,\n              disabled: processing,\n              children: \"Simulate Payment (For Testing)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 407,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.note,\n              children: \"Use this to test the order flow without real payment\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 414,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 402,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 422,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 306,\n    columnNumber: 5\n  }, this);\n};\n_s(PaymentPage, \"+So+VZ+nNTK7KWOqP4gE7Jcsr6k=\", false, function () {\n  return [useSearchParams, useNavigate];\n});\n_c = PaymentPage;\nexport default PaymentPage;\nvar _c;\n$RefreshReg$(_c, \"PaymentPage\");","map":{"version":3,"names":["React","useEffect","useState","useSearchParams","useNavigate","loadStripe","Header","Footer","supabase","createNotification","jsxDEV","_jsxDEV","stripePromise","process","env","REACT_APP_STRIPE_PUBLIC_KEY","PaymentPage","_s","searchParams","navigate","amount","get","isLocal","window","location","hostname","selectedMethod","setSelectedMethod","processing","setProcessing","mpesaPhone","setMpesaPhone","handleStripePayment","orderDataString","sessionStorage","getItem","alert","orderData","JSON","parse","response","fetch","method","headers","body","stringify","parseFloat","sessionId","json","stripe","error","redirectToCheckout","console","handleMpesaPayment","length","phone","orderNumber","result","success","startMpesaPolling","checkoutRequestID","message","attempts","maxAttempts","pollInterval","setInterval","status","clearInterval","createOrderAfterPayment","simulatePayment","log","data","from","insert","payment_status","select","single","details","hint","code","removeItem","customer_email","order_number","word_count","total_price","setTimeout","styles","page","minHeight","display","flexDirection","container","maxWidth","margin","padding","textAlign","card","background","borderRadius","boxShadow","title","fontSize","color","marginBottom","fontWeight","methodsGrid","gap","marginTop","methodCard","border","transition","methodHeader","alignItems","methodTitle","methodButton","cursor","width","disabledCard","opacity","disabledButton","note","fontStyle","input","simulateCard","simulateButton","spinner","marginLeft","style","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","type","placeholder","value","onChange","e","target","_c","$RefreshReg$"],"sources":["D:/Kazi Strong/HumanEyez/src/pages/PaymentPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useSearchParams, useNavigate } from \"react-router-dom\";\r\nimport { loadStripe } from \"@stripe/stripe-js\";\r\nimport Header from \"../components/Header\";\r\nimport Footer from \"../components/Footer\";\r\nimport { supabase, createNotification } from \"../services/supabase\";\r\n\r\nconst stripePromise = loadStripe(process.env.REACT_APP_STRIPE_PUBLIC_KEY || \"\");\r\n\r\nconst PaymentPage = () => {\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n\r\n  const amount = searchParams.get(\"amount\");\r\n  const [isLocal] = useState(window.location.hostname === \"localhost\");\r\n  const [selectedMethod, setSelectedMethod] = useState(null);\r\n  const [processing, setProcessing] = useState(false);\r\n  const [mpesaPhone, setMpesaPhone] = useState(\"\");\r\n\r\n  const handleStripePayment = async () => {\r\n    setProcessing(true);\r\n    setSelectedMethod(\"stripe\");\r\n\r\n    try {\r\n      const orderDataString = sessionStorage.getItem(\"orderToCreate\");\r\n      if (!orderDataString) {\r\n        alert(\"Order data not found\");\r\n        navigate(\"/order\");\r\n        return;\r\n      }\r\n\r\n      const orderData = JSON.parse(orderDataString);\r\n\r\n      // Create Stripe checkout session\r\n      const response = await fetch(\"/api/create-stripe-checkout\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          amount: parseFloat(amount),\r\n          orderData: orderData,\r\n        }),\r\n      });\r\n\r\n      const { sessionId } = await response.json();\r\n\r\n      // Redirect to Stripe checkout\r\n      const stripe = await stripePromise;\r\n      const { error } = await stripe.redirectToCheckout({ sessionId });\r\n\r\n      if (error) {\r\n        console.error(\"Stripe error:\", error);\r\n        alert(\"Payment failed. Please try again.\");\r\n        setProcessing(false);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error:\", error);\r\n      alert(\"Payment failed. Please try again.\");\r\n      setProcessing(false);\r\n    }\r\n  };\r\n\r\n  const handleMpesaPayment = async () => {\r\n    if (!mpesaPhone || mpesaPhone.length < 10) {\r\n      alert(\"Please enter a valid phone number\");\r\n      return;\r\n    }\r\n\r\n    setProcessing(true);\r\n    setSelectedMethod(\"mpesa\");\r\n\r\n    try {\r\n      const orderDataString = sessionStorage.getItem(\"orderToCreate\");\r\n      if (!orderDataString) {\r\n        alert(\"Order data not found\");\r\n        navigate(\"/order\");\r\n        return;\r\n      }\r\n\r\n      const orderData = JSON.parse(orderDataString);\r\n\r\n      // Initiate M-Pesa STK Push\r\n      const response = await fetch(\"/api/mpesa-stk-push\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          phone: mpesaPhone,\r\n          amount: parseFloat(amount),\r\n          orderNumber: \"PENDING\", // Will be created after payment\r\n          orderData: orderData,\r\n        }),\r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      if (result.success) {\r\n        alert(\r\n          \"‚úÖ M-Pesa prompt sent to your phone! Enter your PIN to complete payment.\",\r\n        );\r\n        // Poll for payment confirmation\r\n        startMpesaPolling(result.checkoutRequestID, orderData);\r\n      } else {\r\n        alert(\"M-Pesa payment failed: \" + result.message);\r\n        setProcessing(false);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error:\", error);\r\n      alert(\"Payment failed. Please try again.\");\r\n      setProcessing(false);\r\n    }\r\n  };\r\n\r\n  const startMpesaPolling = (checkoutRequestID, orderData) => {\r\n    let attempts = 0;\r\n    const maxAttempts = 30; // 30 seconds\r\n\r\n    const pollInterval = setInterval(async () => {\r\n      attempts++;\r\n\r\n      try {\r\n        // Check payment status (you'd need to create this endpoint)\r\n        const response = await fetch(\r\n          `/api/mpesa-check-status?id=${checkoutRequestID}`,\r\n        );\r\n        const result = await response.json();\r\n\r\n        if (result.status === \"completed\") {\r\n          clearInterval(pollInterval);\r\n          await createOrderAfterPayment(orderData);\r\n        } else if (result.status === \"failed\" || attempts >= maxAttempts) {\r\n          clearInterval(pollInterval);\r\n          alert(\"Payment failed or timed out\");\r\n          setProcessing(false);\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Polling error:\", error);\r\n      }\r\n    }, 1000);\r\n  };\r\n\r\n  const simulatePayment = async () => {\r\n    setProcessing(true);\r\n    setSelectedMethod(\"simulate\");\r\n\r\n    const orderDataString = sessionStorage.getItem(\"orderToCreate\");\r\n    if (!orderDataString) {\r\n      alert(\"Order data not found. Please start over.\");\r\n      navigate(\"/order\");\r\n      return;\r\n    }\r\n\r\n    const orderData = JSON.parse(orderDataString);\r\n    await createOrderAfterPayment(orderData);\r\n  };\r\n\r\n  const createOrderAfterPayment = async (orderData) => {\r\n    console.log(\"üí≥ Payment successful, creating order...\");\r\n    console.log(\"üì¶ Order data:\", JSON.stringify(orderData, null, 2));\r\n\r\n    const { data, error } = await supabase\r\n      .from(\"orders\")\r\n      .insert([\r\n        {\r\n          ...orderData,\r\n          payment_status: \"paid\",\r\n          status: \"in-progress\",\r\n        },\r\n      ])\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error(\"‚ùå FULL ERROR OBJECT:\", error);\r\n      console.error(\"‚ùå Error message:\", error.message);\r\n      console.error(\"‚ùå Error details:\", error.details);\r\n      console.error(\"‚ùå Error hint:\", error.hint);\r\n      console.error(\"‚ùå Error code:\", error.code);\r\n      alert(`Failed to create order. Error: ${error.message}`);\r\n      setProcessing(false);\r\n      return;\r\n    }\r\n\r\n    console.log(\"‚úÖ Order created:\", data);\r\n\r\n    // Clear session\r\n    sessionStorage.removeItem(\"orderToCreate\");\r\n\r\n    // Notify customer\r\n    await createNotification(\r\n      orderData.customer_email,\r\n      \"new_order\",\r\n      \"Order Placed Successfully! üéâ\",\r\n      `Your order #${data.order_number} has been received and is being processed.`,\r\n      \"/my-orders\",\r\n    );\r\n\r\n    // Notify admin\r\n    await createNotification(\r\n      \"dommienik@yahoo.com\",\r\n      \"new_order\",\r\n      `New Order: #${data.order_number}`,\r\n      `${orderData.customer_email} placed a new order. ${orderData.word_count} words, $${orderData.total_price}`,\r\n      \"/admin\",\r\n    );\r\n\r\n    setTimeout(() => {\r\n      alert(\"‚úÖ Payment Successful! Your order is being processed.\");\r\n      navigate(\"/my-orders\");\r\n    }, 2000);\r\n  };\r\n  const styles = {\r\n    page: { minHeight: \"100vh\", display: \"flex\", flexDirection: \"column\" },\r\n    container: {\r\n      maxWidth: \"600px\",\r\n      margin: \"8rem auto\",\r\n      padding: \"0 2rem\",\r\n      textAlign: \"center\",\r\n    },\r\n    card: {\r\n      background: \"white\",\r\n      borderRadius: \"16px\",\r\n      padding: \"3rem\",\r\n      boxShadow: \"0 8px 24px rgba(0,0,0,0.1)\",\r\n    },\r\n    title: { fontSize: \"2rem\", color: \"#5A3A79\", marginBottom: \"1rem\" },\r\n    amount: {\r\n      fontSize: \"3rem\",\r\n      fontWeight: \"700\",\r\n      color: \"#6B4A8A\",\r\n      marginBottom: \"2rem\",\r\n    },\r\n    methodsGrid: {\r\n      display: \"flex\",\r\n      flexDirection: \"column\",\r\n      gap: \"1.5rem\",\r\n      marginTop: \"2rem\",\r\n    },\r\n    methodCard: {\r\n      padding: \"1.5rem\",\r\n      borderRadius: \"12px\",\r\n      border: \"2px solid #e0e0e0\",\r\n      background: \"white\",\r\n      textAlign: \"left\",\r\n      transition: \"all 0.3s\",\r\n    },\r\n    methodHeader: {\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      gap: \"1rem\",\r\n      marginBottom: \"1rem\",\r\n    },\r\n    methodTitle: { fontSize: \"1.2rem\", fontWeight: \"700\", color: \"#5A3A79\" },\r\n    methodButton: {\r\n      padding: \"1rem\",\r\n      borderRadius: \"8px\",\r\n      border: \"none\",\r\n      background: \"#6B4A8A\",\r\n      color: \"white\",\r\n      cursor: \"pointer\",\r\n      fontSize: \"1rem\",\r\n      fontWeight: \"600\",\r\n      width: \"100%\",\r\n      transition: \"all 0.3s\",\r\n    },\r\n    disabledCard: { opacity: 0.5, background: \"#f5f5f5\" },\r\n    disabledButton: { background: \"#ccc\", cursor: \"not-allowed\" },\r\n    note: {\r\n      fontSize: \"0.9rem\",\r\n      color: \"#6b7e85\",\r\n      marginTop: \"0.5rem\",\r\n      fontStyle: \"italic\",\r\n    },\r\n    input: {\r\n      padding: \"0.8rem\",\r\n      borderRadius: \"8px\",\r\n      border: \"2px solid #e0e0e0\",\r\n      fontSize: \"1rem\",\r\n      width: \"100%\",\r\n      marginBottom: \"1rem\",\r\n    },\r\n    simulateCard: { border: \"2px solid #f39c12\", background: \"#fff9e6\" },\r\n    simulateButton: { background: \"#f39c12\" },\r\n    spinner: {\r\n      display: \"inline-block\",\r\n      marginLeft: \"0.5rem\",\r\n      fontSize: \"1rem\",\r\n    },\r\n  };\r\n\r\n  if (processing) {\r\n    return (\r\n      <div style={styles.page}>\r\n        <Header />\r\n        <div style={styles.container}>\r\n          <div style={styles.card}>\r\n            <h2 style={styles.title}>Processing Payment...</h2>\r\n            <p>Please wait while we process your {selectedMethod} payment.</p>\r\n            <div style={{ fontSize: \"3rem\", margin: \"2rem 0\" }}>‚è≥</div>\r\n          </div>\r\n        </div>\r\n        <Footer />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div style={styles.page}>\r\n      <Header />\r\n\r\n      <div style={styles.container}>\r\n        <div style={styles.card}>\r\n          <h1 style={styles.title}>Complete Payment</h1>\r\n          <div style={styles.amount}>${amount}</div>\r\n\r\n          <div style={styles.methodsGrid}>\r\n            {/* Stripe */}\r\n            <div\r\n              style={{\r\n                ...styles.methodCard,\r\n                ...(isLocal ? styles.disabledCard : {}),\r\n              }}\r\n            >\r\n              <div style={styles.methodHeader}>\r\n                <span style={{ fontSize: \"2rem\" }}>üí≥</span>\r\n                <span style={styles.methodTitle}>Credit/Debit Card</span>\r\n              </div>\r\n              <button\r\n                style={{\r\n                  ...styles.methodButton,\r\n                  ...(isLocal ? styles.disabledButton : {}),\r\n                }}\r\n                onClick={handleStripePayment}\r\n                disabled={isLocal || processing}\r\n              >\r\n                Pay with Stripe\r\n              </button>\r\n              {isLocal && (\r\n                <div style={styles.note}>Available on live site only</div>\r\n              )}\r\n            </div>\r\n\r\n            {/* M-Pesa */}\r\n            <div\r\n              style={{\r\n                ...styles.methodCard,\r\n                ...(isLocal ? styles.disabledCard : {}),\r\n              }}\r\n            >\r\n              <div style={styles.methodHeader}>\r\n                <span style={{ fontSize: \"2rem\" }}>üì±</span>\r\n                <span style={styles.methodTitle}>M-Pesa</span>\r\n              </div>\r\n              {!isLocal && (\r\n                <input\r\n                  type=\"tel\"\r\n                  style={styles.input}\r\n                  placeholder=\"Phone: 0712345678\"\r\n                  value={mpesaPhone}\r\n                  onChange={(e) => setMpesaPhone(e.target.value)}\r\n                />\r\n              )}\r\n              <button\r\n                style={{\r\n                  ...styles.methodButton,\r\n                  ...(isLocal ? styles.disabledButton : {}),\r\n                }}\r\n                onClick={handleMpesaPayment}\r\n                disabled={isLocal || processing}\r\n              >\r\n                Pay with M-Pesa\r\n              </button>\r\n              {isLocal && (\r\n                <div style={styles.note}>Available on live site only</div>\r\n              )}\r\n            </div>\r\n\r\n            {/* PayPal */}\r\n            <div\r\n              style={{\r\n                ...styles.methodCard,\r\n                ...(isLocal ? styles.disabledCard : {}),\r\n              }}\r\n            >\r\n              <div style={styles.methodHeader}>\r\n                <span style={{ fontSize: \"2rem\" }}>üí∞</span>\r\n                <span style={styles.methodTitle}>PayPal</span>\r\n              </div>\r\n              <button\r\n                style={{\r\n                  ...styles.methodButton,\r\n                  ...(isLocal ? styles.disabledButton : {}),\r\n                }}\r\n                disabled={isLocal || processing}\r\n              >\r\n                Pay with PayPal\r\n              </button>\r\n              {isLocal && (\r\n                <div style={styles.note}>Available on live site only</div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Simulate Payment */}\r\n            <div style={{ ...styles.methodCard, ...styles.simulateCard }}>\r\n              <div style={styles.methodHeader}>\r\n                <span style={{ fontSize: \"2rem\" }}>üß™</span>\r\n                <span style={styles.methodTitle}>Test Payment</span>\r\n              </div>\r\n              <button\r\n                style={{ ...styles.methodButton, ...styles.simulateButton }}\r\n                onClick={simulatePayment}\r\n                disabled={processing}\r\n              >\r\n                Simulate Payment (For Testing)\r\n              </button>\r\n              <div style={styles.note}>\r\n                Use this to test the order flow without real payment\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <Footer />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}